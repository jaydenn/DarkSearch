(* ::Package:: *)

(* ::Input:: *)
(*CrediblePlot[data_,nbins_]:=Module[{cl,p,minx,miny,maxx,maxy,xbin,ybin,ydata,binData,ft},*)
(*minx=Min[data[[All,1]]];*)
(*maxx=Max[data[[All,1]]];*)
(*miny=Min[data[[All,2]]];*)
(*maxy=Max[data[[All,2]]];*)
(*xbin=(maxx-minx)/nbins;*)
(*ybin=(maxy-miny)/nbins;*)
(*ft={{Join[Table[{i,Superscript[10,i]},{i,Ceiling[miny]-1,Floor[maxy]+1}],Table[{j+.5,},{j,Round[miny]-1,Round[maxy]+1,1}]],None},{Join[Table[{i,Superscript[10,i]},{i,Ceiling[minx]-1,Floor[maxx]+1}],Table[{j+.5,},{j,Round[minx]-1,Round[maxx]+1,1}]],None}};*)
(*binData=Table[ydata=Select[data,(((j-ybin/2)<#[[2]]<(j+ybin/2))&)];*)
(*Table[Plus@@(Select[ydata,(((i-xbin/2)<#[[1]]<(i+xbin/2))&)][[All,3]]),*)
(*{i,minx-xbin/2,maxx+xbin/2,xbin}],*)
(*{j,miny-ybin/2,maxy+ybin/2,ybin}]//Image//GaussianFilter[#,{1,1}]&//ImageData//ArrayPad[#,1,0]&;*)
(*cl=p/.{FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.95,{p,0,1}],FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.68,{p,0,1}]}//Quiet;*)
(*ListContourPlot[binData,ClippingStyle->Black,Contours->cl,InterpolationOrder->2,ContourStyle->{{Blue,Dashed,Thick},{Blue,Thick}},ContourShading->{None,Opacity[0.2,Blue],Opacity[0.5,Blue]},PlotRange->All,DataRange->{{minx-(3xbin)/2,maxx+(3xbin)/2},{miny-(3ybin)/2,maxy+(3ybin)/2}}]]*)


(* ::Input:: *)
(*LogLogCrediblePlot[data_,nbins_,options___]:=Module[{cl,p,minx,miny,maxx,maxy,xbin,ybin,ydata,binData,logData,ftlog,plot},*)
(*logData=data;*)
(*logData[[All,{1,2}]]=logData[[All,{1,2}]]//Log10;*)
(*minx=Min[logData[[All,1]]];*)
(*maxx=Max[logData[[All,1]]];*)
(*miny=Min[logData[[All,2]]];*)
(*maxy=Max[logData[[All,2]]];*)
(*xbin=(maxx-minx)/nbins;*)
(*ybin=(maxy-miny)/nbins;*)
(*ftlog={{Join[Table[{i,Superscript[10,i],{.012,0}},{i,Floor[miny],Ceiling[maxy]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[miny],Ceiling[maxy],1},{i,.1,.9,.1}]//Flatten[#,1]&],Join[Table[{i,,{.012,0}},{i,Floor[miny],Ceiling[maxy]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[miny],Ceiling[maxy],1},{i,.1,.9,.1}]//Flatten[#,1]&]},{Join[Table[{i,Superscript[10,i],{.012,0}},{i,Floor[minx],Ceiling[maxx]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[minx],Ceiling[maxx],1},{i,.1,.9,.1}]//Flatten[#,1]&],Join[Table[{i,,{.012,0}},{i,Floor[minx],Ceiling[maxx]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[minx],Ceiling[maxx],1},{i,.1,.9,.1}]//Flatten[#,1]&]}};*)
(*binData=Table[ydata=Select[logData,(((j-ybin/2)<#[[2]]<(j+ybin/2))&)];*)
(*Table[Plus@@(Select[ydata,(((i-xbin/2)<#[[1]]<(i+xbin/2))&)][[All,3]]),*)
(*{i,minx-xbin/2,maxx+xbin/2,xbin}],*)
(*{j,miny-ybin/2,maxy+ybin/2,ybin}]//Image//GaussianFilter[#,{1,1}]&//ImageData//ArrayPad[#,1,0]&;*)
(*cl=p/.{FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.95,{p,0,1}],FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.68,{p,0,1}]}//Quiet;*)
(*plot=ListContourPlot[binData,ClippingStyle->Black,Contours->cl,InterpolationOrder->2,ContourStyle->{{Blue,Dashed,Thick},{Blue,Thick}},ContourShading->{None,Opacity[0.2,Blue],Opacity[0.5,Blue]},PlotRange->All,DataRange->{{minx-(3xbin)/2,maxx+(3xbin)/2},{miny-(3ybin)/2,maxy+(3ybin)/2}}];*)
(*Show[plot,FrameTicks->ftlog,options]]*)


(* ::Input:: *)
(*CrediblePlot1D[data_,nbins_]:=Module[{plot,minx,maxx,xbin,binData},*)
(*minx=Min[data[[All,1]]];*)
(*maxx=Max[data[[All,1]]];*)
(*xbin=(maxx-minx)/nbins;*)
(*binData=Table[{i,Plus@@(Select[data,(((i-xbin/2)<#[[1]]<(i+xbin/2))&)][[All,2]])},*)
(*{i,minx-xbin/2,maxx+xbin/2,xbin}];*)
(*plot = ListPlot[binData,Joined->True,PlotRange->All];*)
(*Return[plot];*)
(*];*)


(* ::Input:: *)
(*LogCrediblePlot1D[data_,nbins_,options___]:=Module[{confLimits1,confLimits2,cl,p,minx,miny,maxx,maxy,xbin,ybin,ydata,binData,logData,ftlog,plot},*)
(*logData=data;*)
(*logData[[All,1]]=logData[[All,1]]//Log10;*)
(*minx=Min[logData[[All,1]]];*)
(*maxx=Max[logData[[All,1]]];*)
(*xbin=(maxx-minx)/nbins;*)
(*binData=ParallelTable[Plus@@(Select[logData,(((i-xbin/2)<#[[1]]<(i+xbin/2))&)][[All,2]]),*)
(*{i,minx-xbin/2,maxx+xbin/2,xbin}];*)
(*ftlog={{Automatic,Automatic},{Join[Table[{i,Superscript[10,i],{.012,0}},{i,Floor[minx],Ceiling[maxx]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[minx],Ceiling[maxx],1},{i,.1,.9,.1}]//Flatten[#,1]&],Join[Table[{i,,{.012,0}},{i,Floor[minx],Ceiling[maxx]}],Table[{i 10^j//Log10,,{.006,0}},{j,Floor[minx],Ceiling[maxx],1},{i,.1,.9,.1}]//Flatten[#,1]&]}};*)
(*cl=p/.{FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.95,{p,0,1}],FindRoot[Plus@@Plus@@(binData//# UnitStep[#-p]&)==.68,{p,0,1}]}//Quiet;*)
(*plot=ListPlot[binData,InterpolationOrder->0,Joined->True,PlotRange->{0,1},Frame->True,FrameTicks->ftlog,DataRange->{minx-(3xbin)/2,maxx+(3xbin)/2}];*)
(*confLimits1=ListPlot[binData//# UnitStep[#-cl[[1]]]&,PlotStyle->Dashed,InterpolationOrder->0,PlotRange->All,Joined->True,Filling->Axis];*)
(*confLimits2=ListPlot[binData//# UnitStep[#-cl[[2]]]&,PlotStyle->Dashed,InterpolationOrder->0,PlotRange->All,Joined->True,Filling->Axis];*)
(*Show[plot,confLimits1,confLimits2,options]*)
(*];*)
